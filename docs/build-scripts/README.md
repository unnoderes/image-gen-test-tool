# Windows æ„å»ºè„šæœ¬

æœ¬ç›®å½•åŒ…å«å°†é¡¹ç›®æ‰“åŒ…ä¸º Windows å¯æ‰§è¡Œç¨‹åºçš„æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶ã€‚

## ğŸ“ æ–‡ä»¶è¯´æ˜

### Spec æ–‡ä»¶ï¼ˆPyInstaller é…ç½®ï¼‰

| æ–‡ä»¶ | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| `build_tui.spec` | TUI ç‹¬ç«‹æ‰“åŒ…é…ç½® | ä»…æ‰“åŒ… TUI ç•Œé¢ï¼ˆæ¨èï¼‰ |
| `build_exe.spec` | CLI + TUI æ‰“åŒ…é…ç½® | æ‰“åŒ…å®Œæ•´å·¥å…·ï¼ˆæ–‡ä»¶å¤¹æ¨¡å¼ï¼‰ |
| `build_final.spec` | å®Œæ•´æ‰“åŒ…é…ç½®ï¼ˆå« rich æ•°æ®ï¼‰ | æ‰“åŒ…å®Œæ•´å·¥å…·ï¼ŒåŒ…å«æ‰€æœ‰ä¾èµ– |

### Python è„šæœ¬

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `tui_app.py` | TUI ç‹¬ç«‹å…¥å£è„šæœ¬ï¼ˆè¢« spec æ–‡ä»¶ä½¿ç”¨ï¼‰ |
| `run_tui.py` | TUI è¿è¡Œè„šæœ¬ï¼ˆå¤‡ç”¨ï¼‰ |
| `igt-tui.py` | TUI å…¥å£ç‚¹ï¼ˆå·²åºŸå¼ƒï¼‰ |

### æ‰¹å¤„ç†è„šæœ¬

| æ–‡ä»¶ | è¯´æ˜ | ç”¨æ³• |
|------|------|------|
| `build_windows.bat` | ä¸€é”®æ„å»ºè„šæœ¬ | è‡ªåŠ¨æ„å»º CLI + TUI |
| `test_build.bat` | æ„å»ºæµ‹è¯•è„šæœ¬ | æµ‹è¯•æ„å»ºç»“æœ |
| `package_release.bat` | å‘å¸ƒæ‰“åŒ…è„šæœ¬ | åˆ›å»º ZIP å‘å¸ƒåŒ… |

### æ–‡æ¡£

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `BUILD_SUCCESS.md` | æ„å»ºæˆåŠŸæŠ¥å‘Š |
| `BUILD_REPORT.md` | è¯¦ç»†æ„å»ºæŠ¥å‘Š |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä¸€é”®æ„å»ºï¼ˆæ¨èï¼‰

```cmd
build_windows.bat
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
1. æ£€æŸ¥ Python ç‰ˆæœ¬
2. å®‰è£… PyInstaller
3. å®‰è£…é¡¹ç›®ä¾èµ–
4. æ¸…ç†æ—§æ„å»º
5. æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ„å»º TUIï¼ˆæœ€ç®€å•ï¼‰

```cmd
# 1. å®‰è£…ä¾èµ–
pip install pyinstaller
pip install -e .[tui]

# 2. æ„å»º TUI
pyinstaller build_tui.spec --clean --noconfirm

# 3. è¿è¡Œ
dist\igt-tui.exe
```

### æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨æ„å»ºå®Œæ•´åŒ…

```cmd
# 1. å®‰è£…ä¾èµ–
pip install pyinstaller
pip install -e .[tui]

# 2. æ„å»º
pyinstaller build_final.spec --clean --noconfirm

# 3. æµ‹è¯•
dist\image-gen-test-tool\image-gen-test.exe --help
dist\image-gen-test-tool\igt-tui.exe

# 4. æ‰“åŒ…å‘å¸ƒ
package_release.bat
```

## ğŸ“¦ æ„å»ºäº§ç‰©

æ„å»ºæˆåŠŸåï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä½äºï¼š

```
dist/
â”œâ”€â”€ igt-tui.exe                    # ç‹¬ç«‹ TUI ç¨‹åºï¼ˆ24 MBï¼‰
â””â”€â”€ image-gen-test-tool/           # å®Œæ•´å·¥å…·åŒ…
    â”œâ”€â”€ image-gen-test.exe         # CLI ç¨‹åº
    â”œâ”€â”€ igt-tui.exe                # TUI ç¨‹åº
    â””â”€â”€ _internal/                 # ä¾èµ–åº“
```

## ğŸ”§ é…ç½®è¯´æ˜

### Spec æ–‡ä»¶å…³é”®é…ç½®

```python
# å…¥å£è„šæœ¬
['tui_app.py']  # æˆ– ['cli.py', 'tui_app.py']

# æ•°æ®æ–‡ä»¶
datas=[
    ('.env.example', '.'),
    ('custom_models.json', '.'),
    # ...
]

# éšè—å¯¼å…¥ï¼ˆé‡è¦ï¼ï¼‰
hiddenimports=[
    'textual',
    'textual.widgets',
    'rich',
    'rich._unicode_data',
    # ...
]

# æ’é™¤ä¸éœ€è¦çš„åŒ…
excludes=[
    'tkinter',
    'numpy',
    # ...
]
```

## ğŸ› å¸¸è§é—®é¢˜

### Q1: TUI æ— æ³•å¯åŠ¨ï¼Œæ˜¾ç¤º argparse é”™è¯¯

**A**: ä½¿ç”¨ `build_tui.spec` è€Œä¸æ˜¯ `build_exe.spec`ï¼Œå®ƒä½¿ç”¨ç‹¬ç«‹çš„ TUI å…¥å£ã€‚

### Q2: ç¼ºå°‘ rich æˆ– textual æ¨¡å—

**A**: åœ¨ spec æ–‡ä»¶çš„ `hiddenimports` ä¸­æ·»åŠ ç¼ºå¤±çš„æ¨¡å—ã€‚

### Q3: æ„å»ºå¤±è´¥ï¼Œæç¤ºç›®å½•è¢«å ç”¨

**A**: å…³é—­æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ `igt-tui.exe` å’Œ `image-gen-test.exe` è¿›ç¨‹ã€‚

```cmd
taskkill /F /IM igt-tui.exe
taskkill /F /IM image-gen-test.exe
```

### Q4: æ€æ¯’è½¯ä»¶æŠ¥æ¯’

**A**: è¿™æ˜¯ PyInstaller æ‰“åŒ…ç¨‹åºçš„å¸¸è§é—®é¢˜ï¼Œå±äºè¯¯æŠ¥ã€‚å¯ä»¥ï¼š
- ä¸´æ—¶ç¦ç”¨æ€æ¯’è½¯ä»¶
- å°†ç¨‹åºæ·»åŠ åˆ°ç™½åå•

## ğŸ“ å‘å¸ƒæµç¨‹

1. **æ„å»º**
   ```cmd
   build_windows.bat
   ```

2. **æµ‹è¯•**
   ```cmd
   test_build.bat
   ```

3. **æ‰“åŒ…**
   ```cmd
   package_release.bat
   ```

4. **å‘å¸ƒ**
   - åœ¨ GitHub åˆ›å»º Release
   - ä¸Šä¼ ç”Ÿæˆçš„ ZIP æ–‡ä»¶

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [Windows æ‰“åŒ…è¯¦ç»†æŒ‡å—](../BUILD_WINDOWS.md)
- [å‘å¸ƒæ£€æŸ¥æ¸…å•](../guides/windows-release-checklist.md)
- [å¿«é€Ÿå‚è€ƒ](../guides/windows-build-summary.txt)

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **Python ç‰ˆæœ¬**: éœ€è¦ Python 3.11+
2. **æ„å»ºå¹³å°**: å»ºè®®åœ¨ Windows ä¸Šæ„å»º Windows ç¨‹åº
3. **é¦–æ¬¡æ„å»º**: ç¬¬ä¸€æ¬¡æ„å»ºå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ˆä¸‹è½½ä¾èµ–ï¼‰
4. **æ–‡ä»¶å¤§å°**: å•æ–‡ä»¶æ¨¡å¼è¾ƒå¤§ï¼ˆ~50MBï¼‰ï¼Œæ–‡ä»¶å¤¹æ¨¡å¼è¾ƒå°ï¼ˆ~30MBï¼‰

## ğŸ¯ æ¨èé…ç½®

**å¯¹äºå¤§å¤šæ•°ç”¨æˆ·**ï¼Œæ¨èä½¿ç”¨ `build_tui.spec`ï¼š
- æ„å»ºå¿«é€Ÿ
- ä½“ç§¯é€‚ä¸­ï¼ˆ24 MBï¼‰
- å•æ–‡ä»¶ï¼Œæ–¹ä¾¿åˆ†å‘

**å¯¹äºå®Œæ•´å‘å¸ƒ**ï¼Œä½¿ç”¨ `build_final.spec`ï¼š
- åŒ…å« CLI å’Œ TUI
- æ–‡ä»¶å¤¹æ¨¡å¼
- å¯åŠ¨æ›´å¿«

---

**æœ€åæ›´æ–°**: 2026-02-20
**çŠ¶æ€**: âœ… å·²éªŒè¯å¯ç”¨
